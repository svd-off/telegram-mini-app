<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–ì–æ—Ä–æ–¥—Å–∫–æ–π –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <style>
        *{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent;}
        body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Helvetica,Arial,sans-serif;background:#000;color:#FFF;height:100vh;overflow:hidden;}
       
        .app-container{height:100%;display:flex;flex-direction:column;padding:0 16px 30px 16px;}
        .top-separator{height:1px;background:#2C2C2E;margin:4px 0 10px 0;}
        .final-timer{font-size:26px;font-weight:500;text-align:center;margin:0 0 20px;line-height:1.2;}
        .page{display:none;flex-direction:column;height:100%;}
        .page.active{display:flex;}
        .final-header-row{display:flex;justify-content:space-between;align-items:center;padding-bottom:12px;border-bottom:1px solid #2C2C2E;margin-bottom:8px;position:relative;}
        .final-ticket-number{display:flex;align-items:center;gap:12px;color:#FF3B30;cursor:pointer;z-index:2;}
        .ticket-icon{width:48px;height:48px;flex-shrink:0;}
        #currentTicketNumber{font-size:21px;font-weight:500;letter-spacing:0.3px;white-space:nowrap;}
        .final-control{display:flex;align-items:center;gap:12px;font-size:18px;color:#888;cursor:pointer;z-index:2;}
        .control-icon{width:48px;height:48px;flex-shrink:0;}
        .tab-indicator{position:absolute;bottom:-1px;height:2.5px;background:#FF3B30;border-radius:2px;transition:all 0.3s ease;z-index:1;}
        .ticket-content{flex:1;display:flex;flex-direction:column;}
        .control-content{flex:1;display:none;flex-direction:column;justify-content:flex-start;}
        .final-info-block{flex:1;}
        .info-row{display:flex;align-items:flex-start;gap:0;padding:6px 0 7px;border-bottom:1px solid #2C2C2E;}
        .info-row:last-child{border-bottom:none;}
        .info-icon.big{width:60px;height:60px;margin-right:16px;margin-top:-3px;flex-shrink:0;}
        .info-content{flex:1;}
        .info-label,.route-fromto{font-size:15px;color:#AAAAAA;font-weight:500;margin-bottom:2px;}
        .info-value,.route-number{font-size:19px;font-weight:600;color:#FFFFFF;}
        .final-close-btn{background:#FF3B30;color:#FFF;font-size:19px;font-weight:600;padding:18px 0;border-radius:16px;text-align:center;cursor:pointer;margin-top:28px;box-shadow:0 4px 12px rgba(255,59,48,0.3);}
        .final-close-btn:active{background:#E01E1E;}
        .pay-button{background:#30D158;color:#000;font-size:18px;font-weight:600;padding:20px;border-radius:16px;text-align:center;margin-top:auto;cursor:pointer;}
        .pay-button:active{background:#28A745;}
        .active-tickets-list{flex:1;overflow-y:auto;margin-bottom:12px;}
        .active-ticket-item{background:#1E1E1E;border-radius:12px;padding:16px;margin-bottom:12px;display:flex;align-items:center;justify-content:space-between;cursor:pointer;}
        .active-ticket-item:active{background:#2A2A2C;}
        .delete-btn{width:32px;height:32px;background:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="%23FF3B30" stroke-width="2"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1-2-2h4a2 2 0 0 1-2 2v2"></path><line x1="10" y1="11" x2="10" y2="17"></line><line x1="14" y1="11" x2="14" y2="17"></line></svg>') center/20px no-repeat;cursor:pointer;}
        .close-button{background:#333;color:#FFF;padding:16px;border-radius:12px;text-align:center;font-size:17px;margin-top:16px;cursor:pointer;}
        #accessDenied{position:fixed;top:0;left:0;width:100%;height:100%;background:#000;display:flex;align-items:center;justify-content:center;flex-direction:column;z-index:9999;font-size:24px;color:#FF3B30;}
        .price-selector{background:#1E1E1E;border:1px solid #333;border-radius:12px;padding:14px;margin:16px 0;cursor:pointer;}
        .price-selector:active{background:#2A2A2C;}
        .price-current{font-size:17px;font-weight:600;}
        .price-options{margin-top:10px;display:none;background:#111;padding:12px;border-radius:10px;border:1px solid #333;}
        .price-btn{background:#333;color:#FFF;padding:12px;border-radius:10px;text-align:center;margin-bottom:8px;font-size:16px;cursor:pointer;}
        .price-btn:last-child{margin-bottom:0;}
        .price-btn:active{background:#444;}
        .custom-price-row{display:flex;gap:8px;margin-top:8px;}
        .custom-price{width:100%;background:#000;border:1px solid #444;border-radius:10px;padding:12px;color:#FFF;font-size:16px;text-align:center;}
        .apply-btn{background:#30D158;color:#000;padding:12px 16px;border-radius:10px;font-weight:600;cursor:pointer;}
        .apply-btn:active{background:#28A745;}
        .qr-container{display:flex;flex-direction:column;align-items:center;justify-content:flex-start;flex:1;padding:5px 0 0 0;}
        .qr-code-wrapper{background:#FFF;padding:25px;border-radius:0;margin-bottom:15px;width:100%;max-width:320px;}
        #controlQrCode{width:270px!important;height:270px!important;}
        .control-ticket-number{font-size:26px;font-weight:600;text-align:center;color:#FFF;letter-spacing:0.5px;width:100%;max-width:320px;padding:0;}
        .ticket-number-prefix{color:#FFF;margin-right:8px;}
        .route-database-btn{background:#007AFF;color:#FFF;font-size:17px;font-weight:600;padding:16px 0;border-radius:12px;text-align:center;cursor:pointer;margin-bottom:16px;display:flex;align-items:center;justify-content:center;gap:8px;}
        .route-database-btn:active{background:#0056CC;}
        .route-icon{width:20px;height:20px;background:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>') center/contain no-repeat;}
        .loading-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.8);display:flex;align-items:center;justify-content:center;flex-direction:column;z-index:10000;}
        .loading-spinner{width:40px;height:40px;border:4px solid #333;border-top:4px solid #007AFF;border-radius:50%;animation:spin 1s linear infinite;margin-bottom:16px;}
        @keyframes spin{0%{transform:rotate(0deg);}100%{transform:rotate(360deg);}}
        .loading-text{color:#FFF;font-size:16px;text-align:center;}
        
        /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –±–∞–∑—ã –º–∞—Ä—à—Ä—É—Ç–æ–≤ */
        .routes-modal{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.95);z-index:10001;display:flex;flex-direction:column;padding:20px;}
        .routes-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;}
        .routes-title{font-size:22px;font-weight:600;}
        .routes-close{width:24px;height:24px;background:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>') center/contain no-repeat;cursor:pointer;}
        .routes-search{background:#1E1E1E;border:1px solid #3A3A3C;border-radius:12px;padding:14px;color:#FFF;font-size:16px;width:100%;margin-bottom:16px;}
        .routes-search::placeholder{color:#888;}
        .routes-list{flex:1;overflow-y:auto;display:grid;grid-template-columns:1fr;gap:10px;}
        
        /* –ë–ª–æ–∫ –º–∞—Ä—à—Ä—É—Ç–∞ - –¢–û–õ–¨–ö–û –¥–ª—è –±–∞–∑—ã –º–∞—Ä—à—Ä—É—Ç–æ–≤ */
        .route-block{background:#1E1E1E;border-radius:14px;padding:16px;cursor:pointer;border:1px solid #2C2C2E;transition:all 0.2s ease;}
        .route-block:active{background:#2A2A2C;border-color:#3A3A3C;}
        .route-header{display:flex;align-items:center;gap:8px;margin-bottom:10px;}
        .route-number-db{font-size:20px;font-weight:600;color:#007AFF;}
        .route-type{font-size:14px;color:#AAA;font-weight:500;}
        .route-name{font-size:16px;font-weight:600;margin-bottom:8px;line-height:1.3;}
        .route-carrier{font-size:13px;color:#888;margin-bottom:3px;}
        .route-carrier:last-child{margin-bottom:0;}
        .route-multiple{font-size:12px;color:#007AFF;margin-top:5px;font-weight:500;}
        .no-results{text-align:center;color:#AAA;margin-top:40px;font-size:16px;}
        
        /* –ö–Ω–æ–ø–∫–∏ –≤—ã–±–æ—Ä–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ */
        .quantity-selector{margin:16px 0;}
        .quantity-label{font-size:16px;color:#AAA;margin-bottom:12px;}
        .quantity-buttons{display:flex;gap:10px;}
        .quantity-btn{flex:1;background:#1E1E1E;border:2px solid #333;border-radius:12px;padding:16px 0;text-align:center;font-size:18px;font-weight:600;color:#FFF;cursor:pointer;transition:all 0.2s ease;}
        .quantity-btn.active{background:#007AFF;border-color:#007AFF;color:#FFF;}
        .quantity-btn:active{background:#2A2A2C;}
        
        /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—ã–±–æ—Ä–∞ –ø–µ—Ä–µ–≤–æ–∑—á–∏–∫–∞ */
        .carrier-modal{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.95);z-index:10002;display:flex;flex-direction:column;padding:20px;}
        .carrier-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;}
        .carrier-title{font-size:22px;font-weight:600;}
        .carrier-close{width:24px;height:24px;background:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>') center/contain no-repeat;cursor:pointer;}
        .carrier-route-info{margin-bottom:20px;}
        .carrier-route-number{font-size:20px;font-weight:600;color:#007AFF;margin-bottom:5px;}
        .carrier-route-name{font-size:16px;font-weight:600;}
        .carrier-list{flex:1;overflow-y:auto;display:grid;grid-template-columns:1fr;gap:10px;}
        .carrier-item{background:#1E1E1E;border-radius:14px;padding:16px;cursor:pointer;border:1px solid #2C2C2E;transition:all 0.2s ease;}
        .carrier-item:active{background:#2A2A2C;border-color:#3A3A3C;}
        .carrier-item-text{font-size:15px;font-weight:500;}
        
        /* –ö–Ω–æ–ø–∫–∞ –ö–æ–ø–∏–ª–∫–∞ —É–¥–∞—á–∏ */
        .luck-piggy-btn{background:#FF3B30;color:#FFF;font-size:17px;font-weight:600;padding:16px 0;border-radius:12px;text-align:center;cursor:pointer;margin-top:16px;display:flex;align-items:center;justify-content:center;gap:8px;}
        .luck-piggy-btn:active{background:#E01E1E;}
        .piggy-icon{width:20px;height:20px;background:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white"><path d="M19 5h-2V3H7v2H5c-1.1 0-2 .9-2 2v1c0 2.55 1.92 4.63 4.39 4.94.63 1.5 1.98 2.63 3.61 2.96V19H7v2h10v-2h-4v-3.1c1.63-.33 2.98-1.46 3.61-2.96C19.08 12.63 21 10.55 21 8V7c0-1.1-.9-2-2-2zM5 8V7h2v3.82C5.84 10.4 5 9.3 5 8zm14 0c0 1.3-.84 2.4-2 2.82V7h2v1z"/></svg>') center/contain no-repeat;}
        
        /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ö–æ–ø–∏–ª–∫–∞ —É–¥–∞—á–∏ */
        .luck-modal{position:fixed;top:0;left:0;width:100%;height:100%;background:linear-gradient(180deg, #001a00 0%, #000 100%);z-index:10003;display:flex;flex-direction:column;padding:20px;overflow:hidden;}
        .luck-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:30px;}
        .luck-title{font-size:28px;font-weight:700;color:#FFD700;text-align:center;flex:1;text-shadow:0 0 10px rgba(255,215,0,0.5);}
        .luck-close{width:24px;height:24px;background:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%23FFD700"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>') center/contain no-repeat;cursor:pointer;}
        .luck-content{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;position:relative;}
        .luck-text{font-size:32px;font-weight:700;color:#FFFFFF;text-align:center;margin-bottom:40px;text-shadow:0 0 15px rgba(255,255,255,0.7);}
        .luck-tree{width:200px;height:250px;background:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 125"><path d="M50 5L30 40H20L35 60H25L40 80H30L50 115L70 80H60L75 60H65L80 40H70L50 5Z" fill="%23007a00"/><circle cx="50" cy="20" r="3" fill="%23FFD700"/><circle cx="40" cy="35" r="3" fill="%23FF3B30"/><circle cx="60" cy="35" r="3" fill="%23007AFF"/><circle cx="35" cy="55" r="3" fill="%23FFD700"/><circle cx="50" cy="50" r="3" fill="%23FF3B30"/><circle cx="65" cy="55" r="3" fill="%23007AFF"/><circle cx="45" cy="75" r="3" fill="%23FFD700"/><circle cx="55" cy="75" r="3" fill="%23FF3B30"/></svg>') center/contain no-repeat;margin-bottom:30px;filter:drop-shadow(0 0 20px rgba(0,122,0,0.5));}
        .in-development{font-size:20px;color:#FFD700;text-align:center;margin-top:20px;font-weight:600;}
        
        /* –°–Ω–µ–∂–∏–Ω–∫–∏ */
        .snowflake{position:absolute;top:-20px;color:#FFFFFF;font-size:20px;animation:fall linear infinite;pointer-events:none;opacity:0.8;}
        @keyframes fall{
            0%{transform:translateY(-20px) rotate(0deg);opacity:0.8;}
            100%{transform:translateY(100vh) rotate(360deg);opacity:0;}
        }
    </style>
</head>
<body>
    <div id="accessDenied">–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤</div>
    <div id="loadingOverlay" class="loading-overlay" style="display:none;">
        <div class="loading-spinner"></div>
        <div class="loading-text" id="loadingText">–ó–∞–≥—Ä—É–∂–∞–µ–º —Ñ–æ—Ç–æ...</div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –±–∞–∑—ã –º–∞—Ä—à—Ä—É—Ç–æ–≤ -->
    <div id="routesModal" class="routes-modal" style="display:none;">
        <div class="routes-header">
            <div class="routes-title">–ë–∞–∑–∞ –º–∞—Ä—à—Ä—É—Ç–æ–≤</div>
            <div class="routes-close" onclick="closeRoutesModal()"></div>
        </div>
        <input type="text" id="routesSearch" class="routes-search" placeholder="–ü–æ–∏—Å–∫ –º–∞—Ä—à—Ä—É—Ç–∞ –∏–ª–∏ –ø–µ—Ä–µ–≤–æ–∑—á–∏–∫–∞..." 
               oninput="searchRoutes()" 
               onclick="handleSearchClick(event)">
        <div class="routes-list" id="routesList">
            <!-- –ú–∞—Ä—à—Ä—É—Ç—ã –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∑–¥–µ—Å—å -->
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—ã–±–æ—Ä–∞ –ø–µ—Ä–µ–≤–æ–∑—á–∏–∫–∞ -->
    <div id="carrierModal" class="carrier-modal" style="display:none;">
        <div class="carrier-header">
            <div class="carrier-title">–í—ã–±–µ—Ä–∏—Ç–µ –ø–µ—Ä–µ–≤–æ–∑—á–∏–∫–∞</div>
            <div class="carrier-close" onclick="closeCarrierModal()"></div>
        </div>
        <div class="carrier-route-info">
            <div class="carrier-route-number" id="selectedRouteNumber"></div>
            <div class="carrier-route-name" id="selectedRouteName"></div>
        </div>
        <div class="carrier-list" id="carrierList">
            <!-- –ü–µ—Ä–µ–≤–æ–∑—á–∏–∫–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∑–¥–µ—Å—å -->
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ö–æ–ø–∏–ª–∫–∞ —É–¥–∞—á–∏ -->
    <div id="luckModal" class="luck-modal" style="display:none;">
        <div class="luck-header">
            <div style="width:24px;"></div>
            <div class="luck-title">üéÑ –ö–æ–ø–∏–ª–∫–∞ —É–¥–∞—á–∏ üéÑ</div>
            <div class="luck-close" onclick="closeLuckModal()"></div>
        </div>
        <div class="luck-content" id="luckContent">
            <div class="luck-tree"></div>
            <div class="luck-text">–í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ</div>
            <div class="in-development">–°–∫–æ—Ä–æ –∑–¥–µ—Å—å –±—É–¥–µ—Ç —á—Ç–æ-—Ç–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–µ!</div>
        </div>
    </div>

    <div class="app-container" id="mainApp" style="display:none;">

        <!-- –û–ü–õ–ê–¢–ê ‚Äî –°–†–ê–ó–£ –û–¢–ö–†–´–¢–ê -->
        <div id="paymentPage" class="page active">
            <div style="font-size:18px;font-weight:600;margin-bottom:16px;">–î–∞–Ω–Ω—ã–µ –±–∏–ª–µ—Ç–∞</div>
           
            <div class="route-database-btn" onclick="openRoutesDatabase()">
                <div class="route-icon"></div>
                –ë–∞–∑–∞ –º–∞—Ä—à—Ä—É—Ç–æ–≤
            </div>
            <input type="text" id="carrierInput" placeholder="–ü–µ—Ä–µ–≤–æ–∑—á–∏–∫" style="background:#1E1E1E;border:1px solid #3A3A3C;border-radius:12px;padding:14px;color:#FFF;font-size:16px;width:100%;margin-bottom:16px;">
            <input type="text" id="routeInput" placeholder="–ú–∞—Ä—à—Ä—É—Ç" style="background:#1E1E1E;border:1px solid #3A3A3C;border-radius:12px;padding:14px;color:#FFF;font-size:16px;width:100%;margin-bottom:16px;">
            <input type="text" id="busNumberInput" placeholder="–ù–æ–º–µ—Ä –∞–≤—Ç–æ–±—É—Å–∞" style="background:#1E1E1E;border:1px solid #3A3A3C;border-radius:12px;padding:14px;color:#FFF;font-size:16px;width:100%;margin-bottom:16px;">

            <!-- –ö–Ω–æ–ø–∫–∏ –≤—ã–±–æ—Ä–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ -->
            <div class="quantity-selector">
                <div class="quantity-label">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∏–ª–µ—Ç–æ–≤:</div>
                <div class="quantity-buttons">
                    <div class="quantity-btn active" data-quantity="1" onclick="selectQuantity(1)">1</div>
                    <div class="quantity-btn" data-quantity="2" onclick="selectQuantity(2)">2</div>
                    <div class="quantity-btn" data-quantity="3" onclick="selectQuantity(3)">3</div>
                    <div class="quantity-btn" data-quantity="4" onclick="selectQuantity(4)">4</div>
                    <div class="quantity-btn" data-quantity="5" onclick="selectQuantity(5)">5</div>
                </div>
            </div>

            <div class="price-selector" onclick="document.getElementById('priceOptions').style.display = document.getElementById('priceOptions').style.display==='block'?'none':'block'">
                <div class="price-current">–¶–µ–Ω–∞ –∑–∞ 1 –±–∏–ª–µ—Ç: <span id="currentPriceText">48.00 ‚ÇΩ</span></div>
            </div>
            <div id="priceOptions" class="price-options">
                <div class="price-btn" onclick="setPrice(48)">48.00 ‚ÇΩ</div>
                <div class="price-btn" onclick="setPrice(46)">46.00 ‚ÇΩ</div>
                <div class="custom-price-row">
                    <input type="number" id="customPriceInput" class="custom-price" placeholder="–°–≤–æ—è —Ü–µ–Ω–∞">
                    <div class="apply-btn" onclick="applyCustomPrice()">OK</div>
                </div>
            </div>
            
            <div class="pay-button" onclick="payTicket()">–û–ü–õ–ê–¢–ò–¢–¨ ‚Äî <span id="totalPrice">48.00 ‚ÇΩ</span></div>
            
            <!-- –ö–Ω–æ–ø–∫–∞ –ö–æ–ø–∏–ª–∫–∞ —É–¥–∞—á–∏ -->
            <div class="luck-piggy-btn" onclick="openLuckModal()">
                <div class="piggy-icon"></div>
                –ö–æ–ø–∏–ª–∫–∞ —É–¥–∞—á–∏
            </div>
        </div>

        <!-- –§–ò–ù–ê–õ–¨–ù–´–ô –ë–ò–õ–ï–¢ -->
        <div id="finalTicketPage" class="page">
            <div style="flex:1;display:flex;flex-direction:column;">
                <div class="top-separator"></div>
                <div class="final-timer" id="timer">–î–µ–π—Å—Ç–≤—É–µ—Ç: 15 —Å–µ–∫.</div>
                <div class="final-header-row">
                    <div class="final-ticket-number" onclick="switchToTicket()">
                        <img src="big-ticket.png" class="ticket-icon" alt="–ë–∏–ª–µ—Ç">
                        <span id="currentTicketNumber">1 314 306 766</span>
                    </div>
                    <div class="final-control" onclick="switchToControl()">
                        <img src="control.png" class="control-icon" alt="–ö–æ–Ω—Ç—Ä–æ–ª—å">
                        <span>–ö–æ–Ω—Ç—Ä–æ–ª—å</span>
                    </div>
                    <div class="tab-indicator" id="indicator"></div>
                </div>
                <div id="ticketContent" class="ticket-content">
                    <div class="final-info-block">
                        <div class="info-row">
                            <img src="carrier.png" class="info-icon big">
                            <div class="info-content">
                                <div class="info-label">–ü–µ—Ä–µ–≤–æ–∑—á–∏–∫</div>
                                <div class="info-value" id="finalCarrier">–ò–ü –ß–∏—Ç–∞—à–≤–∏–ª–∏ –ù.–°.</div>
                            </div>
                        </div>
                        <div class="info-row">
                            <img src="bus.png" class="info-icon big">
                            <div class="info-content">
                                <div class="route-fromto" id="finalRouteFromTo">–°–æ–∫–æ–ª–æ–≤—Å–∫–∞—è ‚Äî –°—Ç–µ–ª–∞</div>
                                <div class="route-number" id="finalBusNumber">–≤124–æ–∫124</div>
                            </div>
                        </div>
                        <div class="info-row">
                            <img src="rub.png" class="info-icon big">
                            <div class="info-content">
                                <div class="info-label">–°—Ç–æ–∏–º–æ—Å—Ç—å</div>
                                <div class="info-value" id="finalCost">2 —à—Ç., –ü–æ–ª–Ω—ã–π, 96.00 ‚ÇΩ</div>
                            </div>
                        </div>
                        <div class="info-row">
                            <img src="calendar.png" class="info-icon big">
                            <div class="info-content">
                                <div class="info-label">–î–∞—Ç–∞ –ø–æ–∫—É–ø–∫–∏</div>
                                <div class="info-value" id="purchaseDate">27 –Ω–æ—è–±—Ä—è 2025 –≥.</div>
                            </div>
                        </div>
                        <div class="info-row">
                            <img src="clock.png" class="info-icon big">
                            <div class="info-content">
                                <div class="info-label">–í—Ä–µ–º—è –ø–æ–∫—É–ø–∫–∏</div>
                                <div class="info-value" id="purchaseTime">18:36</div>
                            </div>
                        </div>
                    </div>
                    <div class="final-close-btn" onclick="closeTicket()">–ó–ê–ö–†–´–¢–¨</div>
                </div>
                <div id="controlContent" class="control-content">
                    <div class="qr-container">
                        <div class="qr-code-wrapper">
                            <div id="controlQrCode"></div>
                        </div>
                        <div class="control-ticket-number">
                            <span class="ticket-number-prefix">‚Ññ</span>
                            <span id="controlTicketNumber">1 314 306 766</span>
                        </div>
                    </div>
                    <div class="final-close-btn" onclick="closeTicket()">–ó–ê–ö–†–´–¢–¨</div>
                </div>
            </div>
        </div>

        <!-- –ê–ö–¢–ò–í–ù–´–ï –ë–ò–õ–ï–¢–´ -->
        <div id="activeTicketsPage" class="page">
            <div style="flex:1;display:flex;flex-direction:column;">
                <div style="font-size:18px;font-weight:600;margin-bottom:16px;">–î–µ–π—Å—Ç–≤—É—é—â–∏–µ –±–∏–ª–µ—Ç—ã</div>
                <div class="active-tickets-list" id="activeTicketsList"></div>
                <div class="close-button" onclick="showPage('paymentPage')">–ù–∞–∑–∞–¥</div>
            </div>
        </div>
    </div>

    <script>
        const ALLOWED_USERS = [6107814655, 1777702236];
        const tg = window.Telegram.WebApp;
        tg.expand(); tg.MainButton.hide();
        const userId = tg.initDataUnsafe?.user?.id;

        // –ë–∞–∑–∞ –º–∞—Ä—à—Ä—É—Ç–æ–≤ (–æ–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –ø–µ—Ä–µ–≤–æ–∑—á–∏–∫–∞–º–∏)
        const routesDatabase = [
            // –û–±—ã—á–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã (–æ–¥–∏–Ω –ø–µ—Ä–µ–≤–æ–∑—á–∏–∫)
            {number: "1", type: "—Ç—Ä–æ–ª–ª–µ–π–±—É—Å", name: "–º–∫—Ä–Ω. –°–µ–≤–µ—Ä–Ω—ã–π - –º–∫—Ä–Ω. –¢–∏—Ö–∏–µ –∑–æ—Ä–∏", carrier: "–ú–ü –ì–æ—Ä–æ–¥—Å–∫–æ–π —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç"},
            {number: "2", type: "–∞–≤—Ç–æ–±—É—Å", name: "–î–æ–º —É—á–µ–Ω—ã—Ö - –ê/–í –í–æ—Å—Ç–æ—á–Ω—ã–π", carriers: ["–ò–ü –ì–∞–ª—á–µ–Ω–∫–æ–≤–∞ –ï. –ê.", "–ò–ü –ë–∞–≥–∞–µ–≤ –î.–ë."]},
            {number: "3", type: "–∞–≤—Ç–æ–±—É—Å", name: "–ê–∫–∞–¥–µ–º–≥–æ—Ä–æ–¥–æ–∫ - –∞.–≤–æ–∫–∑. –í–æ—Å—Ç–æ—á–Ω—ã–π", carrier: "–û–û–û \"–°–¢–ö\""},
            {number: "3", type: "–∞–≤—Ç–æ–±—É—Å", name: "–°—Ç—É–¥–≥–æ—Ä–æ–¥–æ–∫ - –∞.–≤–æ–∫–∑. –í–æ—Å—Ç–æ—á–Ω—ã–π", carrier: "–ò–ü –ü–∞—Ç—Ä–∏–Ω –ù. –ù."},
            {number: "4", type: "—Ç—Ä–æ–ª–ª–µ–π–±—É—Å", name: "–ñ/–¥ –≤–æ–∫–∑–∞–ª-–°–µ–≤–µ—Ä–æ-–ó–∞–ø–∞–¥–Ω—ã–π —Ä–∞–π–æ–Ω", carrier: "–ú–ü –ì–æ—Ä–æ–¥—Å–∫–æ–π —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç"},
            {number: "5", type: "–∞–≤—Ç–æ–±—É—Å", name: "–°–ø–æ—Ä—Ç–∫–æ–º–ø–ª–µ–∫—Å \"–†–∞–¥—É–≥–∞\"- –û–û–û \"–ö—Ä–∞—Å—Ñ–∞—Ä–º–∞\"", carrier: "–ò–ü –î–æ–ª–≥—É—à–∏–Ω–∞ –ì.–ò."},
            {number: "6", type: "–∞–≤—Ç–æ–±—É—Å", name: "–¥–∫ \"–ö–∏—Ä–æ–≤—Å–∫–∏–π\" - –ö–∞—Ä–¥–∏–æ—Ü–µ–Ω—Ç—Ä", carriers: ["–ò–ü –¢–∞–≥–∞—á–∞–∫–æ–≤ –í. –ì.", "–û–û–û –¢—Ä–∏—É–º—Ñ-7"]},
            {number: "6", type: "—Ç—Ä–æ–ª–ª–µ–π–±—É—Å", name: "–°—Ç—É–¥–µ–Ω—á–µ—Å–∫–∏–π –≥–æ—Ä–æ–¥–æ–∫ - –£—Ç–∏–Ω—ã–π –ø–ª—ë—Å", carrier: "–ú–ü –ì–æ—Ä–æ–¥—Å–∫–æ–π —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç"},
            {number: "7", type: "–∞–≤—Ç–æ–±—É—Å", name: "—Å—Ç. –ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫-–°–µ–≤–µ—Ä–Ω—ã–π - –î–ö –ö–∏—Ä–æ–≤—Å–∫–∏–π", carrier: "–ò–ü –ì–∞–ª—á–µ–Ω–∫–æ–≤–∞ –ï. –ê."},
            {number: "7", type: "—Ç—Ä–æ–ª–ª–µ–π–±—É—Å", name: "–ñ/–¥ –≤–æ–∫–∑–∞–ª-–°–ø–æ—Ä—Ç–∑–∞–ª", carrier: "–ú–ü –ì–æ—Ä–æ–¥—Å–∫–æ–π —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç"},
            {number: "8", type: "–∞–≤—Ç–æ–±—É—Å", name: "—Å—Ç. –ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫-–°–µ–≤–µ—Ä–Ω—ã–π - –ø–æ—Å. –í–æ–¥–Ω–∏–∫–æ–≤", carrier: "–û–û–û \"–ü–µ—Ä–µ–≤–æ–∑—á–∏–∫\""},
            {number: "9", type: "–∞–≤—Ç–æ–±—É—Å", name: "–ú–µ–∂–¥—É–≥–æ—Ä–æ–¥–Ω—ã–π –∞–≤—Ç–æ–≤–æ–∫–∑–∞–ª - –í.–ë–∞–∑–∞–∏—Ö–∞", carrier: "–û–û–û \"–°–ö–ê–î\""},
            {number: "10", type: "–∞–≤—Ç–æ–±—É—Å", name: "–ø–æ—Å. –≠–Ω–µ—Ä–≥–µ—Ç–∏–∫–æ–≤-–û–ê–û –ö—Ä–∞—Å—Ñ–∞—Ä–º–∞", carrier: "–ö–ü–ê–¢–ü-7"},
            {number: "11", type: "–∞–≤—Ç–æ–±—É—Å", name: "3-—è –î–∞–ª—å–Ω–µ–≤–æ—Å—Ç–æ—á–Ω–∞—è - –ú–æ–ª–æ–¥–µ–∂–Ω–∞—è", carrier: "–ö–ü–ê–¢–ü-5"},
            {number: "12", type: "–∞–≤—Ç–æ–±—É—Å", name: "–º–∫—Ä–Ω. –°–µ–≤–µ—Ä–Ω—ã–π - –ø–æ—Å. –£–¥–∞—á–Ω—ã–π", carrier: "–ö–ü–ê–¢–ü-7"},
            {number: "13", type: "—Ç—Ä–æ–ª–ª–µ–π–±—É—Å", name: "–ñ/–¥ –≤–æ–∫–∑–∞–ª-–°–µ–≤–µ—Ä–æ-–ó–∞–ø–∞–¥–Ω—ã–π —Ä–∞–π–æ–Ω", carrier: "–ú–ü –ì–æ—Ä–æ–¥—Å–∫–æ–π —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç"},
            {number: "14", type: "–∞–≤—Ç–æ–±—É—Å", name: "–ø. –û–≤–∏–Ω–Ω—ã–π-–ñ–¥.–±–æ–ª—å–Ω–∏—Ü–∞", carriers: ["–ê–û \"–°–¢–ö\"", "–ö–ü–ê–¢–ü-5"]},
            {number: "15", type: "—Ç—Ä–æ–ª–ª–µ–π–±—É—Å", name: "–û–ê–û \"–†—É—Å–∞–ª\" - –°–µ–ª—å—Ö–æ–∑–∫–æ–º–ø–ª–µ–∫—Å", carrier: "–ú–ü –ì–æ—Ä–æ–¥—Å–∫–æ–π —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç"},
            {number: "18", type: "–∞–≤—Ç–æ–±—É—Å", name: "–ö–ü–ê–¢–ü ‚Ññ7-–º–∫—Ä–Ω. –í–µ—Ä—Ö–Ω–∏–µ –ß–µ—Ä–µ–º—É—à–∫–∏", carrier: "–ö–ü–ê–¢–ü-7"},
            {number: "19", type: "–∞–≤—Ç–æ–±—É—Å", name: "–°—Ç–µ–ª–∞--–ü—Ä–∏—á–∞–ª", carrier: "–ö–ü–ê–¢–ü-7"},
            {number: "20", type: "–∞–≤—Ç–æ–±—É—Å", name: "–∞/–≤ –í–æ—Å—Ç–æ—á–Ω—ã–π-–ö–∞—Ä–¥–∏–æ—Ü–µ–Ω—Ç—Ä", carrier: "–ò–ü –ü–∞—Ç—Ä–∏–Ω –ù. –ù."},
            {number: "21", type: "–∞–≤—Ç–æ–±—É—Å", name: "–ü–∞—Ä–∫ \"–ü—Ä–∏—â–µ–ø–∫–∞\" - –°–ø–æ—Ä—Ç–∑–∞–ª", carriers: ["–ò–ü –ü–∞—Ç—Ä–∏–Ω –ù. –ù.", "–û–û–û \"–°–¢–ö\""]},
            {number: "22", type: "–∞–≤—Ç–æ–±—É—Å", name: "–ñ–ö \"–Ø—Å–Ω—ã–π\"-–ø–æ—Å. –ò–Ω–¥—É—Å—Ç—Ä–∏–∞–ª—å–Ω—ã–π", carriers: ["–ö–ü–ê–¢–ü-7", "–û–û–û \"–°–ö–ê–î\""]},
            {number: "23", type: "–∞–≤—Ç–æ–±—É—Å", name: "–õ–î–ö - –°–æ–ª–Ω–µ—á–Ω—ã–π (60-–ª–µ—Ç–∏—è –°–°–°–†)", carrier: "–û–û–û –í–µ—Ç–µ—Ä–∞–Ω"},
            {number: "26", type: "–∞–≤—Ç–æ–±—É—Å", name: "–ñ/–¥ –±–æ–ª—å–Ω–∏—Ü–∞ ‚Äì –ü–ª–æ–¥–æ–≤–æ-—è–≥–æ–¥–Ω–∞—è —Å—Ç–∞–Ω—Ü–∏—è", carrier: "–ö–ü–ê–¢–ü-5"},
            {number: "27", type: "–∞–≤—Ç–æ–±—É—Å", name: "–ü–æ–ª–∏–≥–æ–Ω - –ü—Ä–µ–æ–±—Ä–∞–∂–µ–Ω—Å–∫–∏–π", carrier: "–ò–ü –Ø–ª—Ç–æ–Ω—Å–∫–∏–π –ê. –ú."},
            {number: "30", type: "–∞–≤—Ç–æ–±—É—Å", name: "–°–ø–æ—Ä—Ç–∑–∞–ª - –º–∫—Ä–Ω. –¢–∏—Ö–∏–µ –∑–æ—Ä–∏", carrier: "–ö–ü–ê–¢–ü-5"},
            {number: "31", type: "–∞–≤—Ç–æ–±—É—Å", name: "–õ–î–ö-–ê–∫–∞–¥–µ–º–∏—è –±–∏–∞—Ç–ª–æ–Ω–∞", carrier: "–ö–ü–ê–¢–ü-7"},
            {number: "35", type: "–∞–≤—Ç–æ–±—É—Å", name: "–ö–æ–ª—å—Ü–µ–≤–æ–π –º–∞—Ä—à—Ä—É—Ç", carrier: "–ö–ü–ê–¢–ü-5"},
            {number: "37", type: "–∞–≤—Ç–æ–±—É—Å", name: "–∂/–¥ –≤–æ–∫–∑–∞–ª-–§–∞–Ω-–ø–∞—Ä–∫ –ë–æ–±—Ä–æ–≤—ã–π –ª–æ–≥-–ø–æ—Å.–ë–∞–∑–∞–∏—Ö–∞", carrier: "–ö–ü–ê–¢–ü-7"},
            {number: "38", type: "–∞–≤—Ç–æ–±—É—Å", name: "–î–æ–º —É—á—ë–Ω—ã—Ö - –ø–æ—Å. –¢–∞–π–º—ã—Ä", carrier: "–ê–û \"–°–¢–ö\""},
            {number: "43", type: "–∞–≤—Ç–æ–±—É—Å", name: "–í–æ—Å—Ç–æ—á–Ω—ã–π-–°–µ–ª—å—Ö–æ–∑–∫–æ–º–ø–ª–µ–∫—Å", carrier: "–û–û–û –í–∞–≤—É–ª–∏–Ω-–ö"},
            {number: "49", type: "–∞–≤—Ç–æ–±—É—Å", name: "–ö–∞—Ä–¥–∏–æ—Ü–µ–Ω—Ç—Ä ‚Äì –°–ø–æ—Ä—Ç–∫–æ–º–ø–ª–µ–∫—Å \"–†–∞–¥—É–≥–∞\"", carrier: "–ö–ü–ê–¢–ü-5"},
            {number: "50", type: "–∞–≤—Ç–æ–±—É—Å", name: "–°–æ–∫–æ–ª–æ–≤—Å–∫–∞—è - –°—Ç–µ–ª–∞", carrier: "–ò–ü –ß–∏—Ç–∞—à–≤–∏–ª–∏ –ù.–°."},
            {number: "52", type: "–∞–≤—Ç–æ–±—É—Å", name: "–õ–î–ö - –û–∑–µ—Ä–æ-–ø–∞—Ä–∫", carrier: "–ö–ü–ê–¢–ü-5"},
            {number: "55", type: "–∞–≤—Ç–æ–±—É—Å", name: "–ø–æ—Å. –í–æ–¥–Ω–∏–∫–æ–≤-–ñ–µ–ª–µ–∑–Ω–æ–¥–æ—Ä–æ–∂–Ω—ã–π –≤–æ–∫–∑–∞–ª", carrier: "–ö–ü–ê–¢–ü-7"},
            {number: "56", type: "–∞–≤—Ç–æ–±—É—Å", name: "–ø–æ—Å. –®–∏–Ω–Ω–∏–∫–æ–≤ -–ñ–µ–ª–µ–∑–Ω–æ–¥–æ—Ä–æ–∂–Ω—ã–π –≤–æ–∫–∑–∞–ª", carrier: "–ö–ü–ê–¢–ü-7"},
            {number: "58", type: "–∞–≤—Ç–æ–±—É—Å", name: "–ü–∞—Ä–∞—à—é—Ç–Ω–∞—è - –°–ø–æ—Ä—Ç–∑–∞–ª", carriers: ["–ò–ü –ì–æ–ª—É–Ω—Ü–æ–≤ –°. –í.", "–ò–ü –ö—Ä–∏–≤–æ–Ω–æ–≥–æ–≤ –ò.–ì."]},
            {number: "60", type: "–∞–≤—Ç–æ–±—É—Å", name: "–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª –í–æ—Å—Ç–æ—á–Ω—ã–π - –ü–µ—Ç—Ä—É—à–∏–Ω–∞", carrier: "–ò–ü –¶—É–≥–ª–µ–Ω–æ–∫ –ú.–ú."},
            {number: "61", type: "–∞–≤—Ç–æ–±—É—Å", name: "–º–∫—Ä–Ω. –°–æ–ª–Ω–µ—á–Ω—ã–π - –®–∏–Ω–Ω–æ–µ –∫–ª–∞–¥–±–∏—â–µ", carrier: "–û–û–û –ö–ü–ê–¢–ü"},
            {number: "63", type: "–∞–≤—Ç–æ–±—É—Å", name: "–ê–∫–∞–¥–µ–º–≥–æ—Ä–æ–¥–æ–∫ - –°–æ–ª–Ω–µ—á–Ω—ã–π", carrier: "–û–û–û –ö–ü–ê–¢–ü"},
            {number: "64", type: "–∞–≤—Ç–æ–±—É—Å", name: "–º–∫—Ä–Ω. –°–æ–ª–Ω–µ—á–Ω—ã–π - –º–∫—Ä–Ω. –¢–∏—Ö–∏–µ –∑–æ—Ä–∏", carrier: "–ö–ü–ê–¢–ü-5"},
            {number: "65", type: "–∞–≤—Ç–æ–±—É—Å", name: "–î–ö –ö–∏—Ä–æ–≤—Å–∫–∏–π - –ê–≥—Ä–æ—Ç–µ—Ä–º–∏–Ω–∞–ª", carrier: "–ò–ü –Ø–ª—Ç–æ–Ω—Å–∫–∏–π –ê. –ú."},
            {number: "69", type: "–∞–≤—Ç–æ–±—É—Å", name: "–º–∫—Ä–Ω. –°–æ–ª–Ω–µ—á–Ω—ã–π - –ø–æ—Å. –ò–Ω–¥—É—Å—Ç—Ä–∏–∞–ª—å–Ω—ã–π", carrier: "–ö–ü–ê–¢–ü-7"},
            {number: "71", type: "–∞–≤—Ç–æ–±—É—Å", name: "–°–ø–æ—Ä—Ç–∑–∞–ª - –ø–æ—Å. –¢–∞–π–º—ã—Ä", carriers: ["–ò–ü –ì–∞–ª—á–µ–Ω–∫–æ–≤–∞ –ï. –ê.", "–ò–ü –ì–∞–ª—á–µ–Ω–∫–æ–≤–∞ –û. –ì."]},
            {number: "77", type: "–∞–≤—Ç–æ–±—É—Å", name: "–ñ/–¥ –±–æ–ª—å–Ω–∏—Ü–∞ - –ø–æ—Å. –ü–µ—Å—á–∞–Ω–∫–∞", carriers: ["–û–û–û –ü—Ä–∞–∫—Ç–∏–∫", "–û–û–û –°–∏–±–∏—Ä—å–ê–≤—Ç–æ"]},
            {number: "78", type: "–∞–≤—Ç–æ–±—É—Å", name: "–°—Ç–µ–ª–∞ - –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–Ω—ã–π –¥–≤–æ—Ä", carriers: ["–ò–ü –ë—Ä–æ–Ω–Ω–∏–∫–æ–≤ –ê.–ò.", "–ò–ü –ë—Ä–æ–Ω–Ω–∏–∫–æ–≤ –ú. –ê."]},
            {number: "80", type: "–∞–≤—Ç–æ–±—É—Å", name: "–ø–æ—Å.–¢–∞–π–º—ã—Ä-–º–∫—Ä–Ω. –¢–∏—Ö–∏–µ –ó–æ—Ä–∏", carrier: "–ò–ü –î–æ–ª–≥—É—à–∏–Ω –î.–ì."},
            {number: "81", type: "–∞–≤—Ç–æ–±—É—Å", name: "–ñ/–¥ –±–æ–ª—å–Ω–∏—Ü–∞ - –°–∏–±–∏—Ä—Å–∫–∏–π —ç–ª–µ–º–µ–Ω—Ç", carrier: "–û–û–û –°–∏—Ä–µ–Ω–∞"},
            {number: "83", type: "–∞–≤—Ç–æ–±—É—Å", name: "–î–æ–º —É—á—ë–Ω—ã—Ö - –ø—Ä. –£–ª—å—è–Ω–æ–≤—Å–∫–∏–π", carrier: "–ò–ü –¶—É–≥–ª–µ–Ω–æ–∫ –ú.–ú."},
            {number: "85", type: "–∞–≤—Ç–æ–±—É—Å", name: "–î–∞—É—Ä—Å–∫–∞—è - –°–µ–ª—å—Ö–æ–∑–∫–æ–º–ø–ª–µ–∫—Å", carriers: ["–û–û–û \"–°–ö–ê–î\"", "–û–û–û \"–°–¢–ö\""]},
            {number: "87", type: "–∞–≤—Ç–æ–±—É—Å", name: "–°–æ–ª–Ω–µ—á–Ω—ã–π ‚Äì –ú–æ–ª–æ–¥–µ–∂–Ω–∞—è", carrier: "–ö–ü–ê–¢–ü-5"},
            {number: "88", type: "–∞–≤—Ç–æ–±—É—Å", name: "–°–ø–æ—Ä—Ç–∑–∞–ª - –ê–∫–∞–¥–µ–º–∏—è –±–∏–∞—Ç–ª–æ–Ω–∞", carrier: "–ò–ü –¢–∞–≥–∞—á–∞–∫–æ–≤ –í. –ì."},
            {number: "90", type: "–∞–≤—Ç–æ–±—É—Å", name: "–ê–∫. –±–∏–∞—Ç–ª–æ–Ω–∞-–í–µ—Ä—Ö–Ω. –ë–∞–∑–∞–∏—Ö–∞", carrier: "–ò–ü –ü–∞—Ç—Ä–∏–Ω –ù. –ù."},
            {number: "92", type: "–∞–≤—Ç–æ–±—É—Å", name: "–ö—Ä–∞—Å—Ñ–∞—Ä–º–∞ (60 –ª–µ—Ç –û–∫—Ç—è–±—Ä—è) - –•/–ö –ï–Ω–∏—Å–µ–π", carrier: "–ò–ü –ü–∞—Ç—Ä–∏–Ω –ù. –ù."},
            {number: "94", type: "–∞–≤—Ç–æ–±—É—Å", name: "–õ–î–ö - –¢–≠–¶-3", carriers: ["–ò–ü –ö–∞—Ä–∞—Å–µ–≤–∞ –ù. –ù.", "–û–û–û –ú–∞—Ä—à—Ä—É—Ç–ê–≤—Ç–æ", "–û–û–û –ü—Ä–∞–∫—Ç–∏–∫"]},
            {number: "95", type: "–∞–≤—Ç–æ–±—É—Å", name: "–í–µ—Ä—Ö–Ω–∏–µ –ß–µ—Ä–µ–º—É—à–∫–∏-–õ–î–ö", carrier: "–ö–ü–ê–¢–ü-7"},
            {number: "98", type: "–∞–≤—Ç–æ–±—É—Å", name: "–õ–î–ö - –û–ê–û \"–†–£–°–ê–õ\"", carrier: "–ò–ü –ì–Ω–µ—Ç–æ–≤ –Æ.–ù."},
            {number: "99", type: "–∞–≤—Ç–æ–±—É—Å", name: "–°–µ–≤–µ—Ä–Ω—ã–π-–¶–∏–º–ª—è–Ω—Å–∫–∞—è", carriers: ["–ò–ü –ü–∞—Ç—Ä–∏–Ω –ù. –ù.", "–û–û–û \"–°–¢–ö\""]},
            {number: "5—Ç", type: "—Ç—Ä–æ–ª–ª–µ–π–±—É—Å", name: "—Å—Ç.–ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫-–°–µ–≤–µ—Ä–Ω—ã–π - –≠–∫–æ–ø–∞—Ä–∫ –ì—Ä–µ–º—è—á–∞—è –≥—Ä–∏–≤–∞", carrier: "–ú–ü –ì–æ—Ä–æ–¥—Å–∫–æ–π —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç"},
            {number: "173", type: "–∞–≤—Ç–æ–±—É—Å", name: "–ú–µ–∂–¥—É–≥–æ—Ä–æ–¥–Ω—ã–π –∞/–≤ - –ø–æ—Å. –ë–µ—Ä–µ–∑–æ–≤–∫–∞", carrier: "–û–û–û \"–ö–æ–Ω—Ç—É—Ä\""}
        ];

        if (!userId || !ALLOWED_USERS.includes(userId)) {
            document.getElementById('accessDenied').style.display = 'flex';
        } else {
            document.getElementById('accessDenied').style.display = 'none';
            document.getElementById('mainApp').style.display = 'flex';

            let viewTimer, viewSecondsLeft = 15;
            const TOTAL_DURATION = 90 * 60 * 1000;
            let tickets = JSON.parse(localStorage.getItem('user_tickets') || '[]');
            const now = Date.now();
            tickets = tickets.filter(t => now - t.created_at < TOTAL_DURATION);
            localStorage.setItem('user_tickets', JSON.stringify(tickets));

            if (tickets.length > 0) {
                showPage('activeTicketsPage');
                renderActiveTickets();
            } else {
                showPage('paymentPage');
            }

            let ticketPrice = 48.00;
            let selectedQuantity = 1;
            let selectedRouteForCarrier = null; // –î–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –º–∞—Ä—à—Ä—É—Ç–∞ –ø—Ä–∏ –≤—ã–±–æ—Ä–µ –ø–µ—Ä–µ–≤–æ–∑—á–∏–∫–∞
            let snowflakeInterval = null; // –î–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏ —Å–Ω–µ–∂–∏–Ω–æ–∫

            // –î–ª—è —Å–∫—Ä—ã—Ç–∏—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º —Ç–∞–ø–µ
            let searchFieldLastClick = 0;
            
            function handleSearchClick(event) {
                const now = Date.now();
                const searchField = document.getElementById('routesSearch');
                
                // –ï—Å–ª–∏ –ø–æ–ª–µ —É–∂–µ –≤ —Ñ–æ–∫—É—Å–µ –∏ –±—ã–ª –Ω–µ–¥–∞–≤–Ω–∏–π –∫–ª–∏–∫ - —Å–∫—Ä—ã–≤–∞–µ–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É
                if (document.activeElement === searchField && (now - searchFieldLastClick < 300)) {
                    searchField.blur(); // –°–∫—Ä—ã–≤–∞–µ–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É
                }
                
                searchFieldLastClick = now;
            }

            function openRoutesDatabase() {
                renderRoutesList(routesDatabase);
                document.getElementById('routesModal').style.display = 'flex';
                document.getElementById('routesSearch').focus();
            }

            function closeRoutesModal() {
                document.getElementById('routesModal').style.display = 'none';
                document.getElementById('routesSearch').value = '';
                document.getElementById('routesSearch').blur();
                renderRoutesList(routesDatabase);
            }

            function closeCarrierModal() {
                document.getElementById('carrierModal').style.display = 'none';
                selectedRouteForCarrier = null;
            }

            function openLuckModal() {
                document.getElementById('luckModal').style.display = 'flex';
                startSnowflakes();
            }

            function closeLuckModal() {
                document.getElementById('luckModal').style.display = 'none';
                stopSnowflakes();
            }

            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–Ω–µ–∂–∏–Ω–æ–∫
            function startSnowflakes() {
                stopSnowflakes(); // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —Å–Ω–µ–∂–∏–Ω–∫–∏
                
                const snowflakes = ['‚ùÑÔ∏è', '‚ú¶', '‚ùÖ', '‚ùÜ', '‚Ä¢'];
                const content = document.getElementById('luckContent');
                
                snowflakeInterval = setInterval(() => {
                    const snowflake = document.createElement('div');
                    snowflake.className = 'snowflake';
                    snowflake.textContent = snowflakes[Math.floor(Math.random() * snowflakes.length)];
                    
                    // –°–ª—É—á–∞–π–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è –ø–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–∏
                    snowflake.style.left = Math.random() * 100 + '%';
                    
                    // –°–ª—É—á–∞–π–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å
                    const duration = 3 + Math.random() * 5;
                    snowflake.style.animationDuration = duration + 's';
                    
                    // –°–ª—É—á–∞–π–Ω—ã–π —Ä–∞–∑–º–µ—Ä
                    const size = 15 + Math.random() * 25;
                    snowflake.style.fontSize = size + 'px';
                    
                    content.appendChild(snowflake);
                    
                    // –£–¥–∞–ª—è–µ–º —Å–Ω–µ–∂–∏–Ω–∫—É –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∞–Ω–∏–º–∞—Ü–∏–∏
                    setTimeout(() => {
                        if (snowflake.parentNode) {
                            snowflake.parentNode.removeChild(snowflake);
                        }
                    }, duration * 1000);
                    
                }, 150); // –ù–æ–≤–∞—è —Å–Ω–µ–∂–∏–Ω–∫–∞ –∫–∞–∂–¥—ã–µ 150ms
            }

            function stopSnowflakes() {
                if (snowflakeInterval) {
                    clearInterval(snowflakeInterval);
                    snowflakeInterval = null;
                }
                
                // –£–¥–∞–ª—è–µ–º –≤—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å–Ω–µ–∂–∏–Ω–∫–∏
                document.querySelectorAll('.snowflake').forEach(snowflake => {
                    if (snowflake.parentNode) {
                        snowflake.parentNode.removeChild(snowflake);
                    }
                });
            }

            function renderRoutesList(routes) {
                const routesList = document.getElementById('routesList');
                routesList.innerHTML = '';
                
                if (routes.length === 0) {
                    routesList.innerHTML = '<div class="no-results">–ü–æ –≤–∞—à–µ–º—É –∑–∞–ø—Ä–æ—Å—É –Ω–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</div>';
                    return;
                }
                
                routes.forEach(route => {
                    const routeBlock = document.createElement('div');
                    routeBlock.className = 'route-block';
                    
                    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º, –µ—Å—Ç—å –ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–µ—Ä–µ–≤–æ–∑—á–∏–∫–æ–≤
                    const hasMultipleCarriers = route.carriers && route.carriers.length > 1;
                    
                    routeBlock.onclick = () => handleRouteClick(route);
                    
                    // –°–æ–∑–¥–∞–µ–º HTML –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ –º–∞—Ä—à—Ä—É—Ç–∞
                    let carriersHTML = '';
                    
                    if (hasMultipleCarriers) {
                        // –î–ª—è –º–∞—Ä—à—Ä—É—Ç–æ–≤ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –ø–µ—Ä–µ–≤–æ–∑—á–∏–∫–∞–º–∏
                        route.carriers.forEach((carrier, index) => {
                            carriersHTML += `<div class="route-carrier">${index + 1}. ${carrier}</div>`;
                        });
                        carriersHTML += `<div class="route-multiple">–í—ã–±–µ—Ä–∏—Ç–µ –ø–µ—Ä–µ–≤–æ–∑—á–∏–∫–∞</div>`;
                    } else {
                        // –î–ª—è –æ–±—ã—á–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤ (–æ–¥–∏–Ω –ø–µ—Ä–µ–≤–æ–∑—á–∏–∫)
                        const carrier = route.carrier || (route.carriers && route.carriers[0]) || '';
                        carriersHTML = `<div class="route-carrier">${carrier}</div>`;
                    }
                    
                    routeBlock.innerHTML = `
                        <div class="route-header">
                            <div class="route-number-db">${route.number}</div>
                            <div class="route-type">(${route.type})</div>
                        </div>
                        <div class="route-name">${route.name}</div>
                        ${carriersHTML}
                    `;
                    
                    routesList.appendChild(routeBlock);
                });
            }

            function handleRouteClick(route) {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–µ—Ä–µ–≤–æ–∑—á–∏–∫–æ–≤
                const hasMultipleCarriers = route.carriers && route.carriers.length > 1;
                
                if (hasMultipleCarriers) {
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ–∫–Ω–æ –≤—ã–±–æ—Ä–∞ –ø–µ—Ä–µ–≤–æ–∑—á–∏–∫–∞
                    selectedRouteForCarrier = route;
                    showCarrierSelection(route);
                } else {
                    // –û–±—ã—á–Ω—ã–π –º–∞—Ä—à—Ä—É—Ç - —Å—Ä–∞–∑—É –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ–º
                    const carrier = route.carrier || (route.carriers && route.carriers[0]) || '';
                    selectRoute(route, carrier);
                }
            }

            function showCarrierSelection(route) {
                document.getElementById('selectedRouteNumber').textContent = `–ú–∞—Ä—à—Ä—É—Ç ‚Ññ${route.number} (${route.type})`;
                document.getElementById('selectedRouteName').textContent = route.name;
                
                const carrierList = document.getElementById('carrierList');
                carrierList.innerHTML = '';
                
                route.carriers.forEach((carrier, index) => {
                    const carrierItem = document.createElement('div');
                    carrierItem.className = 'carrier-item';
                    carrierItem.onclick = () => selectCarrier(carrier);
                    
                    carrierItem.innerHTML = `
                        <div class="carrier-item-text">${carrier}</div>
                    `;
                    
                    carrierList.appendChild(carrierItem);
                });
                
                document.getElementById('carrierModal').style.display = 'flex';
            }

            function selectCarrier(carrier) {
                if (selectedRouteForCarrier) {
                    selectRoute(selectedRouteForCarrier, carrier);
                    closeCarrierModal();
                }
            }

            function selectRoute(route, carrier) {
                document.getElementById('carrierInput').value = carrier;
                document.getElementById('routeInput').value = route.name;
                document.getElementById('busNumberInput').value = '';
                closeRoutesModal();
                
                tg.showPopup({
                    title: "–ú–∞—Ä—à—Ä—É—Ç –≤—ã–±—Ä–∞–Ω!",
                    message: `–ú–∞—Ä—à—Ä—É—Ç ‚Ññ${route.number} (${carrier})`,
                    buttons: [{type: 'ok', text: '–û—Ç–ª–∏—á–Ω–æ!'}]
                });
            }

            function searchRoutes() {
                const searchTerm = document.getElementById('routesSearch').value.toLowerCase();
                
                if (!searchTerm) {
                    renderRoutesList(routesDatabase);
                    return;
                }
                
                const filtered = routesDatabase.filter(route => {
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–æ–º–µ—Ä –º–∞—Ä—à—Ä—É—Ç–∞
                    if (route.number.toLowerCase().includes(searchTerm)) return true;
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ –º–∞—Ä—à—Ä—É—Ç–∞
                    if (route.name.toLowerCase().includes(searchTerm)) return true;
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–∏–ø —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞
                    if (route.type.toLowerCase().includes(searchTerm)) return true;
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–µ—Ä–µ–≤–æ–∑—á–∏–∫–æ–≤ (–æ–¥–∏–Ω –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ)
                    if (route.carrier && route.carrier.toLowerCase().includes(searchTerm)) return true;
                    if (route.carriers) {
                        for (const carrier of route.carriers) {
                            if (carrier.toLowerCase().includes(searchTerm)) return true;
                        }
                    }
                    
                    return false;
                });
                
                renderRoutesList(filtered);
            }

            function selectQuantity(qty) {
                selectedQuantity = qty;
                
                // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —É –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫
                document.querySelectorAll('.quantity-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                
                // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å –∫ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–Ω–æ–ø–∫–µ
                document.querySelector(`.quantity-btn[data-quantity="${qty}"]`).classList.add('active');
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Ü–µ–Ω—É
                updatePrice();
            }

            function showLoading(text = '–ó–∞–≥—Ä—É–∑–∫–∞...') {
                document.getElementById('loadingText').textContent = text;
                document.getElementById('loadingOverlay').style.display = 'flex';
            }
            function hideLoading() { document.getElementById('loadingOverlay').style.display = 'none'; }

            function setPrice(price) {
                ticketPrice = parseFloat(price);
                document.getElementById('currentPriceText').textContent = ticketPrice.toFixed(2) + ' ‚ÇΩ';
                document.getElementById('priceOptions').style.display = 'none';
                updatePrice();
            }
            function applyCustomPrice() {
                const val = document.getElementById('customPriceInput').value.trim();
                if (val && parseFloat(val) > 0) setPrice(parseFloat(val));
            }
            function updatePrice() {
                const total = (ticketPrice * selectedQuantity).toFixed(2);
                document.getElementById('totalPrice').textContent = total + ' ‚ÇΩ';
            }

            function payTicket() {
                const qty = selectedQuantity;
                const carrier = document.getElementById('carrierInput').value.trim() || "–ò–ü –ß–∏—Ç–∞—à–≤–∏–ª–∏ –ù.–°.";
                const route = document.getElementById('routeInput').value.trim();
                const busNumber = document.getElementById('busNumberInput').value.trim().toLowerCase() || "–≤124–æ–∫124";
                const totalAmount = (ticketPrice * qty).toFixed(2);
                const ticketNum = `1 ${random3()} ${random3()} ${random3()}`;
                const d = new Date();
                const purchaseDate = d.toLocaleDateString('ru-RU', { day: '2-digit', month: 'long', year: 'numeric' }).replace(' ', ' ').slice(0, -3) + ' –≥.';
                const purchaseTime = d.toLocaleTimeString('ru-RU', { hour: '2-digit', minute: '2-digit' });

                tickets.push({ number: ticketNum, carrier, route, busNumber, quantity: qty, price: ticketPrice, created_at: Date.now(), purchaseDate, purchaseTime });
                localStorage.setItem('user_tickets', JSON.stringify(tickets));

                document.getElementById('currentTicketNumber').textContent = ticketNum;
                document.getElementById('controlTicketNumber').textContent = ticketNum;
                document.getElementById('finalCarrier').textContent = carrier;
                document.getElementById('finalRouteFromTo').textContent = route.replace(/-/g, '‚Äî');
                document.getElementById('finalBusNumber').textContent = busNumber;
                document.getElementById('finalCost').textContent = qty + ' —à—Ç., –ü–æ–ª–Ω—ã–π, ' + totalAmount + ' ‚ÇΩ';
                document.getElementById('purchaseDate').textContent = purchaseDate;
                document.getElementById('purchaseTime').textContent = purchaseTime;

                generateQrCode(ticketNum);
                showPage('finalTicketPage');
                switchToTicket();
                startViewTimer();
            }

            function generateQrCode(ticketNumber) {
                const qrContainer = document.getElementById('controlQrCode');
                qrContainer.innerHTML = '';
                new QRCode(qrContainer, { text: ticketNumber, width: 270, height: 270, colorDark: "#000000", colorLight: "#ffffff", correctLevel: QRCode.CorrectLevel.H });
            }

            function switchToTicket() {
                document.getElementById('ticketContent').style.display = 'flex';
                document.getElementById('controlContent').style.display = 'none';
                document.querySelector('.final-ticket-number').style.color = '#FF3B30';
                document.querySelector('.final-control span').style.color = '#888';
                const indicator = document.getElementById('indicator');
                indicator.style.left = '0px';
                indicator.style.width = document.querySelector('.final-ticket-number').offsetWidth + 'px';
            }

            function switchToControl() {
                document.getElementById('ticketContent').style.display = 'none';
                document.getElementById('controlContent').style.display = 'flex';
                document.querySelector('.final-ticket-number').style.color = '#888';
                document.querySelector('.final-control span').style.color = '#FF3B30';
                const controlEl = document.querySelector('.final-control');
                const indicator = document.getElementById('indicator');
                indicator.style.left = (controlEl.getBoundingClientRect().left - controlEl.parentElement.getBoundingClientRect().left) + 'px';
                indicator.style.width = controlEl.offsetWidth + 'px';
            }

            function random3() { return Math.floor(Math.random() * 900) + 100; }

            function startViewTimer() {
                viewSecondsLeft = 15;
                document.getElementById('timer').textContent = '–î–µ–π—Å—Ç–≤—É–µ—Ç: ' + viewSecondsLeft + ' —Å–µ–∫.';
                clearInterval(viewTimer);
                viewTimer = setInterval(() => {
                    viewSecondsLeft--;
                    document.getElementById('timer').textContent = '–î–µ–π—Å—Ç–≤—É–µ—Ç: ' + viewSecondsLeft + ' —Å–µ–∫.';
                    if (viewSecondsLeft <= 0) {
                        clearInterval(viewTimer);
                        showPage(tickets.length > 0 ? 'activeTicketsPage' : 'paymentPage');
                        renderActiveTickets();
                    }
                }, 1000);
            }

            function closeTicket() {
                clearInterval(viewTimer);
                showPage(tickets.length > 0 ? 'activeTicketsPage' : 'paymentPage');
                renderActiveTickets();
            }

            function showPage(id) {
                document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
                document.getElementById(id).classList.add('active');
                if (id === 'finalTicketPage') setTimeout(switchToTicket, 50);
                if (id === 'activeTicketsPage') renderActiveTickets();
            }

            function renderActiveTickets() {
                const list = document.getElementById('activeTicketsList'); list.innerHTML = '';
                if (tickets.length === 0) {
                    list.innerHTML = '<div style="text-align:center;color:#AAA;margin-top:20px;">–ù–µ—Ç –±–∏–ª–µ—Ç–æ–≤</div>';
                    return;
                }
                tickets.forEach((t, i) => {
                    const mins = Math.floor((TOTAL_DURATION - (Date.now() - t.created_at)) / 60000);
                    const total = (t.price * t.quantity).toFixed(2);
                    const el = document.createElement('div'); el.className = 'active-ticket-item';
                    el.onclick = () => {
                        document.getElementById('currentTicketNumber').textContent = t.number;
                        document.getElementById('controlTicketNumber').textContent = t.number;
                        document.getElementById('finalCarrier').textContent = t.carrier;
                        document.getElementById('finalRouteFromTo').textContent = t.route.replace(/-/g, '‚Äî');
                        document.getElementById('finalBusNumber').textContent = t.busNumber;
                        document.getElementById('finalCost').textContent = t.quantity + ' —à—Ç., –ü–æ–ª–Ω—ã–π, ' + total + ' ‚ÇΩ';
                        document.getElementById('purchaseDate').textContent = t.purchaseDate;
                        document.getElementById('purchaseTime').textContent = t.purchaseTime;
                        generateQrCode(t.number);
                        showPage('finalTicketPage');
                        switchToTicket();
                        startViewTimer();
                    };
                    el.innerHTML = `<div><div style="font-weight:600;">–ë–∏–ª–µ—Ç ‚Ññ ${t.number}</div><div style="font-size:14px;color:#AAA">–û—Å—Ç–∞–ª–æ—Å—å: ${mins} –º–∏–Ω</div></div><div class="delete-btn" onclick="event.stopPropagation();deleteTicket(${i})"></div>`;
                    list.appendChild(el);
                });
            }

            function deleteTicket(i) {
                tg.showPopup({ title: "–£–¥–∞–ª–∏—Ç—å –±–∏–ª–µ—Ç?", message: "–ë–µ–∑ –≤–æ–∑–≤—Ä–∞—Ç–∞", buttons: [{ type: 'destructive', text: '–£–¥–∞–ª–∏—Ç—å', id: 'del' }, { type: 'cancel' }] }, b => {
                    if (b === 'del') {
                        tickets.splice(i, 1);
                        localStorage.setItem('user_tickets', JSON.stringify(tickets));
                        renderActiveTickets();
                    }
                });
            }

            document.addEventListener('DOMContentLoaded', () => {
                updatePrice();
            });
        }
    </script>
</body>
</html>
